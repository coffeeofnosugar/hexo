---
title: 【Unity】【C#】事件和委托
date: 2023-08-12 11:19:06
tags:
  - Unity
  - C#
---


### 委托

委托可以把一个方法代入另一个方法，相当于指向函数的指针，换句话说，委托相当于一个函数指针

总的来说，委托是一个类，该类内部维护着一个字段，指向一个方法。

委托的声明：`public delegate void DoDelegate();`

```C#
// 测试方法
void Test(object sender, EventArgs e)
{
    Console.Write($"valueStr={sender}");
}
// 定义委托
public delegate void DoDelegate(object sender, EventArgs e);

// 实例化委托——只是实例化，并不会执行
DoDelegate doDelegate = new DoDelegate(Test);
object sender = 888;
EventArgs e = new EventArgs();
// 执行委托的两种方法
// 方法一:
doDelegate?.Invoke(sender, e);
// 方法二:
doDelegate(sender, e);
```

-----

### 事件

事件相当于保存委托的数组

事件是基于委托的，为委托提供一个订阅或发布的机制。事件是一种特殊的委托，调用事件和委托是一样的。

事件可以被看作是委托类型的一个变量，通过事件注册、取消多个委托和方法。

public event 委托类型 事件名称；
如：`public event DoDelegate DoEvent;`

```C#
// 测试方法
void Test(object sender, EventArgs e)
{
    Console.Write($"valueStr={sender}");
}
// 定义委托
public delegate void DoDelegate(object sender, EventArgs e);
// 定义事件
public event DODelegate DoEvent;

object sender = 888;
EventArgs e = new EventArgs();
// 两种用法
// 1.给事件注册委托
// 2.给事件直接注册方法
// 用法一（给事件注册委托）：
// 给事件注册委托，可注册多个委托
DoEvent += new DoDelegate(doDelegate);
// 执行事件内所有的委托
DoEvent(sender, e);

// 用法二（给事件注册方法）：
// 给事件注册方法，可注册多个方法
DoEvent += Test;
// 执行事件内所有的方法
DoEvent(sender, e);
```
